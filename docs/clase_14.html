<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clase 14: Animaciones e interactividad &mdash; documentación de Clases de Python - </title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Clase 15: Interfaces con otros lenguajes" href="clase_15.html" />
    <link rel="prev" title="Clase 13: Interpolación y ajuste de curvas (fiteo)" href="clase_13.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Clases de Python
            <img src="_static/logo.svg" class="logo" alt="Logotipo"/>
          </a>
              <div class="version">
                IB - 2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Dictado de las clases</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="clase_00.html">Clase 0: Introducción al lenguaje Python orientado a Ingenierías y Física</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_01.html">Clase 1: Introducción al lenguaje</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_02.html">Clase 2: Tipos de datos y control</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_03.html">Clase 3: Tipos complejos y control de flujo</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_04.html">Clase 4: Funciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_05.html">Clase 5: Entrada y salida, decoradores, y errores</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_06.html">Clase 6: Programación Orientada a Objetos</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_07.html">Clase 7: Control de versiones y biblioteca standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_08.html">Clase 8: Introducción a Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_09.html">Clase 9: Visualización</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_10.html">Clase 10: Más información sobre <strong>Numpy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_11.html">Clase 11: Introducción al paquete Scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_12.html">Clase 12: Un poco de graficación 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_13.html">Clase 13: Interpolación y ajuste de curvas (fiteo)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Clase 14: Animaciones e interactividad</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#animaciones-con-matploblib">Animaciones con <strong>Matploblib</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#una-animacion-simple-en-pocos-pasos">Una animación simple en pocos pasos</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#preparacion-general">Preparación general</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creamos-los-datos-para-graficar">Creamos los datos para graficar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparacion-de-la-figura">Preparación de la figura</a></li>
<li class="toctree-l4"><a class="reference internal" href="#funcion-para-actualizar-la-linea">Función para actualizar la línea</a></li>
<li class="toctree-l4"><a class="reference internal" href="#animacion-de-la-figura">Animación de la figura</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opcional-grabar-la-animacion-a-un-archivo">Opcional: grabar la animación a un archivo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#segundo-ejemplo-simple-quiver">Segundo ejemplo simple: Quiver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#comentarios">Comentarios:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tercer-ejemplo">Tercer ejemplo</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ejercicios-14-a">Ejercicios 14 (a)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#trabajo-simple-con-imagenes">Trabajo simple con imágenes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#analisis-de-la-imagen">Análisis de la imagen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#histograma-de-intensidades">Histograma de intensidades</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cortes-en-una-direccion">Cortes en una dirección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ejercicios-14-b">Ejercicios 14 (b)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graficos-interactivos-widgets">Gráficos interactivos (“widgets”)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cursor">Cursor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manejo-de-eventos">Manejo de eventos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ejemplos-integrados">Ejemplos integrados</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ejercicios-14-c">Ejercicios 14 (c)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clase_15.html">Clase 15: Interfaces con otros lenguajes</a></li>
<li class="toctree-l1"><a class="reference internal" href="clase_16.html">Clase 16: Programación funcional con Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ejercicios de Clase</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ejercicios.html">Ejercicios</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="programa_detalle.html">Programa Detallado</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Clases de Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Clase 14: Animaciones e interactividad</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/clase_14.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="clase-14-animaciones-e-interactividad">
<span id="clase-14"></span><h1>Clase 14: Animaciones e interactividad<a class="headerlink" href="#clase-14-animaciones-e-interactividad" title="Permalink to this heading"></a></h1>
<section id="animaciones-con-matploblib">
<h2>Animaciones con <strong>Matploblib</strong><a class="headerlink" href="#animaciones-con-matploblib" title="Permalink to this heading"></a></h2>
<p><strong>Matplotlib</strong> tiene funciones para hacer animaciones de una manera
conveniente. Hay excelente información sobre el tema en:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://matplotlib.org/api/animation_api.html">La documentación (con
ejemplos)</a></p></li>
<li><p><a class="reference external" href="http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/">Tutorial en Pythonic
Perambulations</a></p></li>
</ul>
<p>Vamos a ver brevemente cómo hacer animaciones, en pocos Pasos</p>
<section id="una-animacion-simple-en-pocos-pasos">
<h3>Una animación simple en pocos pasos<a class="headerlink" href="#una-animacion-simple-en-pocos-pasos" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">scripts</span><span class="o">/</span><span class="n">animaciones</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">fiol</span><span class="o">/</span><span class="n">Clases</span><span class="o">/</span><span class="n">IntPython</span><span class="o">/</span><span class="n">clases</span><span class="o">-</span><span class="n">python</span><span class="o">/</span><span class="n">clases</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">animaciones</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">tk</span>
<span class="o">%</span><span class="n">run</span> <span class="n">ejemplo_animation_1</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
<span class="c1"># Creamos los datos</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">Npts</span><span class="o">=</span> <span class="mi">50</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">Npts</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">update_line</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
  <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">line</span><span class="p">,</span>

<span class="c1"># Creamos la figura e inicializamos</span>
<span class="c1"># Graficamos una línea sin ningún punto</span>
<span class="c1"># Fijamos las condiciones de graficación</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">L</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;-o&#39;</span><span class="p">)</span> <span class="c1"># equivalente a la siguiente</span>
<span class="c1"># L = plt.plot([],[] , &#39;-o&#39;)[0]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Animación de una oscilación&#39;</span><span class="p">)</span>


<span class="c1">#</span>
<span class="n">line_ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig1</span><span class="p">,</span> <span class="n">update_line</span><span class="p">,</span> <span class="n">Npts</span><span class="p">,</span> <span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Este código da como resultado una función oscilante que se va creando.
Este es un ejemplo simple que puede ser útil para graficar datos de una
medición o de un cálculo más o menos largo.</p>
<img alt="_images/line.gif" src="_images/line.gif" />
<section id="preparacion-general">
<h4>Preparación general<a class="headerlink" href="#preparacion-general" title="Permalink to this heading"></a></h4>
<p>Como vemos, después de importar el submódulo <code class="docutils literal notranslate"><span class="pre">animation</span></code> (además de lo
usual):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</pre></div>
</div>
<p>nos aseguramos que estamos trabajando en modo <strong>no</strong> interactivo (con
<code class="docutils literal notranslate"><span class="pre">plt.ioff()</span></code>).</p>
</section>
<section id="creamos-los-datos-para-graficar">
<h4>Creamos los datos para graficar<a class="headerlink" href="#creamos-los-datos-para-graficar" title="Permalink to this heading"></a></h4>
<p>Creación de datos para graficar</p>
<p>Creamos los datos para mostrar en la animación.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xmax</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">Npts</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">Npts</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
</pre></div>
</div>
<p>Acá <code class="docutils literal notranslate"><span class="pre">data</span></code> es un array 2D, con los datos <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>.</p>
</section>
<section id="preparacion-de-la-figura">
<h4>Preparación de la figura<a class="headerlink" href="#preparacion-de-la-figura" title="Permalink to this heading"></a></h4>
<p>A continuación preparamos la zona de graficación:</p>
<ol class="arabic simple">
<li><p>Creamos la figura y eje</p></li>
<li><p>Creamos las líneas de graficación (una en este caso)</p></li>
<li><p>Fijamos los límites de graficación</p></li>
<li><p>Agregamos el texto, que va a ser invariante durante la animación</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">L</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Animación de una oscilación&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Como sabemos, el llamado a <code class="docutils literal notranslate"><span class="pre">plot()</span></code> devuelve una lista de líneas (de
un solo elemento). A este elemento lo llamamos <code class="docutils literal notranslate"><span class="pre">L</span></code>, y ya le damos las
características que queremos que tenga. En este caso, fijamos el símbolo
(círculos), con líneas de ancho 3. Vamos a modificar esta línea <code class="docutils literal notranslate"><span class="pre">L</span></code> en
cada cuadro de la animación.</p>
</section>
<section id="funcion-para-actualizar-la-linea">
<h4>Función para actualizar la línea<a class="headerlink" href="#funcion-para-actualizar-la-linea" title="Permalink to this heading"></a></h4>
<p>Debemos crear una función que modifique las curvas en cada cuadro.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_line</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
  <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">line</span><span class="p">,</span>
</pre></div>
</div>
<p>Esta función debe recibir como argumento el número de cuadro, que acá
llamamos <code class="docutils literal notranslate"><span class="pre">num</span></code>. Además, en este caso recibe los datos a graficar, y la
línea a modificar.</p>
<p>Esta función devuelve una línea <code class="docutils literal notranslate"><span class="pre">L</span></code>, que es la parte del gráfico que
queremos que se actualice en cada frame.</p>
<p>Notemos acá que no es necesario que tome como argumento los datos
guardados en <code class="docutils literal notranslate"><span class="pre">data</span></code> y la línea <code class="docutils literal notranslate"><span class="pre">line</span></code>, ya que son variables globales
a las que hay acceso dentro del <em>script</em>. De la misma manera no es
necesario que devuelva la línea, por la misma razón.</p>
</section>
<section id="animacion-de-la-figura">
<h4>Animación de la figura<a class="headerlink" href="#animacion-de-la-figura" title="Permalink to this heading"></a></h4>
<p>Finalmente llamamos a la función que hace la animación:
<code class="docutils literal notranslate"><span class="pre">animation.FuncAnimation()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="n">np</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block"> FuncAnimation(fig, func, frames=None, init_func=None, fargs=None,
               save_count=None, <em>, cache_frame_data=True, **kwargs)

Makes an animation by repeatedly calling a function *func</em>.

.. note::

    You must store the created Animation in a variable that lives as long
    as the animation should run. Otherwise, the Animation object will be
    garbage-collected and the animation stops.

Parameters
----------
fig : <cite>~matplotlib.figure.Figure</cite>
    The figure object used to get needed events, such as draw or resize.

func : callable
    The function to call at each frame.  The first argument will
    be the next value in <em>frames</em>.   Any additional positional
    arguments can be supplied via the <em>fargs</em> parameter.

    The required signature is::

        def func(frame, <em>fargs) -&gt; iterable_of_artists

    If ``blit == True``, *func</em> must return an iterable of all artists
    that were modified or created. This information is used by the blitting
    algorithm to determine which parts of the figure have to be updated.
    The return value is unused if <code class="docutils literal notranslate"><span class="pre">blit</span> <span class="pre">==</span> <span class="pre">False</span></code> and may be omitted in
    that case.

frames : iterable, int, generator function, or None, optional
    Source of data to pass <em>func</em> and each frame of the animation

    - If an iterable, then simply use the values provided.  If the
      iterable has a length, it will override the <em>save_count</em> kwarg.

    - If an integer, then equivalent to passing <code class="docutils literal notranslate"><span class="pre">range(frames)</span></code>

    - If a generator function, then must have the signature::

         def gen_function() -&gt; obj

    - If <em>None</em>, then equivalent to passing <code class="docutils literal notranslate"><span class="pre">itertools.count</span></code>.

    In all of these cases, the values in <em>frames</em> is simply passed through
    to the user-supplied <em>func</em> and thus can be of any type.

init_func : callable, optional
    A function used to draw a clear frame. If not given, the results of
    drawing from the first item in the frames sequence will be used. This
    function will be called once before the first frame.

    The required signature is::

        def init_func() -&gt; iterable_of_artists

    If <code class="docutils literal notranslate"><span class="pre">blit</span> <span class="pre">==</span> <span class="pre">True</span></code>, <em>init_func</em> must return an iterable of artists
    to be re-drawn. This information is used by the blitting algorithm to
    determine which parts of the figure have to be updated.  The return
    value is unused if <code class="docutils literal notranslate"><span class="pre">blit</span> <span class="pre">==</span> <span class="pre">False</span></code> and may be omitted in that case.

fargs : tuple or None, optional
    Additional arguments to pass to each call to <em>func</em>.

save_count : int, default: 100
    Fallback for the number of values from <em>frames</em> to cache. This is
    only used if the number of frames cannot be inferred from <em>frames</em>,
    i.e. when it's an iterator without length or a generator.

interval : int, default: 200
    Delay between frames in milliseconds.

repeat_delay : int, default: 0
    The delay in milliseconds between consecutive animation runs, if
    <em>repeat</em> is True.

repeat : bool, default: True
    Whether the animation repeats when the sequence of frames is completed.

blit : bool, default: False
    Whether blitting is used to optimize drawing.  Note: when using
    blitting, any animated artists will be drawn according to their zorder;
    however, they will be drawn on top of any previous artists, regardless
    of their zorder.

cache_frame_data : bool, default: True
    Whether frame data is cached.  Disabling cache might be helpful when
    frames contain large objects.


Methods:

  new_frame_seq  --  Return a new sequence of frame information.
  new_saved_frame_seq  --  Return a new sequence of saved/cached frame information.
  pause  --  Pause the animation.
  resume  --  Resume the animation.
  save  --  Save the animation as a movie file by drawing every frame.
  to_html5_video  --  Convert the animation to an HTML5 <code class="docutils literal notranslate"><span class="pre">&lt;video&gt;</span></code> tag.
  to_jshtml  --  Generate HTML representation of the animation.</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">line_anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig1</span><span class="p">,</span> <span class="n">update_line</span><span class="p">,</span> <span class="n">Npts</span><span class="p">,</span>
                   <span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>La función <code class="docutils literal notranslate"><span class="pre">FuncAnimation()</span></code> toma como argumentos:</p>
<ul class="simple">
<li><p>la figura (<code class="docutils literal notranslate"><span class="pre">fig1</span></code>) donde se realiza el gráfico.</p></li>
<li><p>Una función a la que llama antes de dibujar cada <em>frame</em>
(<code class="docutils literal notranslate"><span class="pre">update_line</span></code>),</p></li>
<li><p>El argumento <code class="docutils literal notranslate"><span class="pre">interval</span></code> da el tiempo entre cuadros, en
milisegundos.</p></li>
<li><p>El argumento <code class="docutils literal notranslate"><span class="pre">fargs</span></code> es una tuple con los argumentos que necesita
la función <code class="docutils literal notranslate"><span class="pre">update_line()</span></code>. En este caso <code class="docutils literal notranslate"><span class="pre">(data,</span> <span class="pre">L)</span></code>.</p></li>
<li><p>El argumento <code class="docutils literal notranslate"><span class="pre">blit=True</span></code> hace que sólo se actualicen las partes que
cambian en la animación, mientras que las partes estáticas no se
dibujan en cada cuadro.</p></li>
</ul>
<p>Es importante que el objeto creado por <code class="docutils literal notranslate"><span class="pre">FuncAnimation()</span></code> no se
destruya. Esto lo podemos asegurar asignando el objeto resultante a una
variable, en este caso line_anim.</p>
</section>
<section id="opcional-grabar-la-animacion-a-un-archivo">
<h4>Opcional: grabar la animación a un archivo<a class="headerlink" href="#opcional-grabar-la-animacion-a-un-archivo" title="Permalink to this heading"></a></h4>
<p>Podemos grabar la animación a un archivo usando el método <code class="docutils literal notranslate"><span class="pre">save()</span></code> o
el método <code class="docutils literal notranslate"><span class="pre">to_html5_video()</span></code> del objeto (<code class="docutils literal notranslate"><span class="pre">anim</span></code>) que devuelve la
función <code class="docutils literal notranslate"><span class="pre">FuncAnimation()</span></code>.</p>
<p>Para poder grabar a archivo las animaciones se necesita tener instalados
programas externos (alguno de <em>ffmpeg</em>, <em>avconv</em>, <em>imagemagick</em>). Ver
<a class="reference external" href="https://matplotlib.org/api/animation_api.html">https://matplotlib.org/api/animation_api.html</a> para más información.</p>
</section>
</section>
<section id="segundo-ejemplo-simple-quiver">
<h3>Segundo ejemplo simple: Quiver<a class="headerlink" href="#segundo-ejemplo-simple-quiver" title="Permalink to this heading"></a></h3>
<p>Para hacer una animación de un campo de fuerzas o velocidades
necesitamos datos en tres dimensiones. El siguiente ejemplo sigue los
pasos de la animación anterior, excepto en la creación de datos y la
graficación, que en lugar de usar <code class="docutils literal notranslate"><span class="pre">plot()</span></code> usa <code class="docutils literal notranslate"><span class="pre">quiver()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>

<span class="c1"># ############################################################</span>
<span class="c1"># Creación de datos</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">91</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">91</span><span class="p">)</span>
<span class="n">X3</span><span class="p">,</span> <span class="n">Y3</span><span class="p">,</span> <span class="n">T3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sinT3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">T3</span> <span class="o">/</span>
               <span class="n">T3</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">X3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sinT3</span>
<span class="c1"># Graficar una flecha cada step puntos</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x_q</span><span class="p">,</span> <span class="n">y_q</span> <span class="o">=</span> <span class="n">x</span><span class="p">[::</span><span class="n">step</span><span class="p">],</span> <span class="n">y</span><span class="p">[::</span><span class="n">step</span><span class="p">]</span>

<span class="c1"># Create U and V vectors to plot</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">G</span><span class="p">[::</span><span class="n">step</span><span class="p">,</span> <span class="p">::</span><span class="n">step</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># ############################################################</span>
<span class="c1"># Figura y ejes.</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">qax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x_q</span><span class="p">,</span> <span class="n">y_q</span><span class="p">,</span> <span class="n">U</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
  <span class="n">qax</span><span class="o">.</span><span class="n">set_UVC</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig1</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># anim.save(&#39;quiver.gif&#39;, writer=&#39;imagemagick&#39;)</span>
<span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;quiver.mp4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">ejemplo_quiver</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<img alt="_images/quiver.gif" src="_images/quiver.gif" />
<section id="comentarios">
<h4>Comentarios:<a class="headerlink" href="#comentarios" title="Permalink to this heading"></a></h4>
<ul>
<li><p>Se utilizó la función <code class="docutils literal notranslate"><span class="pre">quiver()</span></code> para generar un campo vectorial.
La forma de esta función es:</p>
<p>quiver([X, Y], U, V, [C], **kw)</p>
<p><em>X</em>, <em>Y</em> define the arrow locations, <em>U</em>, <em>V</em> define the arrow
directions, and <em>C</em> optionally sets the color.</p>
</li>
<li><p>Se utilizaron <em>Ellipsis</em>, por ejemplo en casos como:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Las elipsis (tres puntos o la palabra <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code>) indican todo el
rango para todas las dimensiones que no se dan explícitamente. En
este ejemplo el <em>array</em> <code class="docutils literal notranslate"><span class="pre">U</span></code> tiene tres dimensiones, por lo que
tendremos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>En general, las elipses reemplazan a los dos puntos en todas las
dimensiones no dadas explícitamente</p>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">a4</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mi">0</span>  <span class="mi">6</span> <span class="mi">12</span> <span class="mi">18</span> <span class="mi">24</span> <span class="mi">30</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">6</span> <span class="mi">12</span> <span class="mi">18</span> <span class="mi">24</span> <span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a4</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a4</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span> <span class="mi">0</span>  <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">6</span>  <span class="mi">9</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">12</span> <span class="mi">15</span><span class="p">]]</span>
<span class="p">[[</span> <span class="mi">0</span>  <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">6</span>  <span class="mi">9</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">12</span> <span class="mi">15</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a4</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">a4</span><span class="p">[:,:,:,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Uso de <code class="docutils literal notranslate"><span class="pre">np.roll(a,</span> <span class="pre">shift,</span> <span class="pre">axis=None)</span></code> que mueve elementos una
distancia <code class="docutils literal notranslate"><span class="pre">shift</span></code> a lo largo del eje <code class="docutils literal notranslate"><span class="pre">axis</span></code>, y cuando pasan la
última posición los reintroduce al principio. Por ejemplo, en una
dimensión:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="tercer-ejemplo">
<h3>Tercer ejemplo<a class="headerlink" href="#tercer-ejemplo" title="Permalink to this heading"></a></h3>
<p>Veamos un ejemplo similar al primero, pero donde vamos cambiando los
límites de los ejes en forma manual, a medida que los datos lo requieren</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>

<span class="c1"># Calcula los datos en tiempo real.</span>
<span class="k">def</span> <span class="nf">data_gen</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="mf">0.1</span>
    <span class="k">yield</span> <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">10.</span><span class="p">)</span>


<span class="c1"># Necesitamos que se puede acceder a estas variables</span>
<span class="c1"># desde varias funciones -&gt; globales</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="k">del</span> <span class="n">xdata</span><span class="p">[:]</span>
  <span class="k">del</span> <span class="n">ydata</span><span class="p">[:]</span>
  <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">line</span><span class="p">,</span>


<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="c1"># update the data</span>
  <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span>
  <span class="n">xdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
  <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>

  <span class="c1"># Si los datos salen del eje, agrandamos el eje</span>
  <span class="c1"># Después tenemos que redibujar el canvas manualmente</span>
  <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">xmax</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">line</span><span class="p">,</span>

<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">data_gen</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">animate_decay</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">reload_library</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="ejercicios-14-a">
<h2>Ejercicios 14 (a)<a class="headerlink" href="#ejercicios-14-a" title="Permalink to this heading"></a></h2>
<ol class="arabic">
<li><p>Utilizando <strong>Matplotlib</strong>:</p>
<ul class="simple">
<li><p>Hacer un gráfico donde dibuje una parábola <span class="math notranslate nohighlight">\(y = x^{2}\)</span> en el
rango <span class="math notranslate nohighlight">\([-5,5]\)</span>.</p></li>
<li><p>En el mismo gráfico, agregar un círculo en <span class="math notranslate nohighlight">\(x=-5\)</span>.</p></li>
<li><p>El círculo debe moverse siguiendo la curva, como se muestra en la
figura</p></li>
</ul>
<img alt="_images/pelota.gif" src="_images/pelota.gif" />
</li>
<li><p><strong>PARA ENTREGAR. Caída libre 2:</strong> Modificar el ejercicio de la clase
8 de caída libre que entregó, para aceptar dos nuevas opciones:</p>
<ul class="simple">
<li><p>La opción <code class="docutils literal notranslate"><span class="pre">--vx</span></code> permite dar una velocidad inicial en la
dirección horizontal.</p></li>
<li><p>La opción <code class="docutils literal notranslate"><span class="pre">--animate</span></code>, tal que cuando se utilice, el programa
muestre una animación de la trayectoria.</p></li>
<li><p>La animación tiene que tener un cartel indicando el tiempo, y la
velocidad y altura correspondiente a ese tiempo.</p></li>
<li><p>Agregue una “cola fantasma” a la partícula, que muestre posiciones
anteriores.</p></li>
</ul>
<p>Envíe el programa llamado <strong>14_Suapellido.py</strong> en un adjunto por
correo electrónico, con asunto: <strong>14_Suapellido</strong></p>
</li>
</ol>
<hr class="docutils" />
<p>.</p>
</section>
<section id="trabajo-simple-con-imagenes">
<h2>Trabajo simple con imágenes<a class="headerlink" href="#trabajo-simple-con-imagenes" title="Permalink to this heading"></a></h2>
<p>Vamos a empezar leyendo y mostrando algunas imágenes, para entender cómo
es su representación. Para leer y escribir imágenes vamos a usar el
paquete adicional <code class="docutils literal notranslate"><span class="pre">imageio</span></code>. <strong>Scipy</strong> tiene funciones (con el mismo
nombre) para realizar este trabajo en el submódulo <code class="docutils literal notranslate"><span class="pre">misc</span></code> pero está
planeado que desaparezcan en un futuro no muy lejano.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
<p>El siguiente ejemplo es una figura tomada de algunas pruebas que hicimos
en el laboratorio hace unos años. Es el resultado de la medición de
flujo en toberas</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">imag1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;figuras/imagen_flujo.jpg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;La imagen &quot;imag1&quot; es del tipo: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">imag1</span><span class="p">)</span><span class="si">}</span><span class="s1"> con &quot;shape&quot; </span><span class="si">{</span><span class="n">imag1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag1</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>La imagen &quot;imag1&quot; es del tipo: &lt;class &#39;numpy.ndarray&#39;&gt; con &quot;shape&quot; (272, 652, 3)
</pre></div>
</div>
<img alt="_images/14_2_interactivo_3_1.png" src="_images/14_2_interactivo_3_1.png" />
<p>La representación de la imagen es una matriz, donde cada elemento
corresponde a un pixel, y cada pixel tiene tres valores. El elemento
<code class="docutils literal notranslate"><span class="pre">[0,0]</span></code> corresponde al pixel ubicado en la esquina superior izquierda,
el elemento <code class="docutils literal notranslate"><span class="pre">[-1,0]</span></code> al pixel ubicado en la esquina inferior
izquierda, mientras que el <code class="docutils literal notranslate"><span class="pre">[0,-1]</span></code> a la esquina superior derecha:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag1</span><span class="p">)</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;[0,0]&quot;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="p">{},</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;[-1,0]&quot;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">272</span><span class="p">),</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">240</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="p">{},</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;[0,-1]&quot;</span><span class="p">,(</span><span class="mi">652</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">510</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="p">{},</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_5_0.png" src="_images/14_2_interactivo_5_0.png" />
<p>En consecuencia podemos ver qué valores toma cada pixel</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">imag1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>             <span class="c1"># El primer elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imag1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>             <span class="c1"># El segundo elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imag1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">imag1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># y sus valores mínimo y máximo</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">65</span> <span class="mi">65</span> <span class="mi">65</span><span class="p">]</span>
<span class="p">[</span><span class="mi">66</span> <span class="mi">66</span> <span class="mi">66</span><span class="p">]</span>
<span class="mi">0</span> <span class="mi">255</span>
</pre></div>
</div>
<p>Como vemos en cada pixel el valor está dado por un array de tres números
enteros</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">imag1</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Como originalmente teníamos una figura en escala de grises, podemos
convertir los tres colores a una simple escala, por ejemplo promediando
los tres valores. La función <code class="docutils literal notranslate"><span class="pre">imread()</span></code> puede interpretar la figura
como una escala de grises con los argumentos adecuados:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">imag2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;figuras/imagen_flujo_gray.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>La variable <code class="docutils literal notranslate"><span class="pre">imag2</span></code> contiene ahora una matriz con las dimensiones de
la imagen (272 x 652) pero con sólo un valor por cada pixel</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">imag2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imag2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">272</span><span class="p">,</span> <span class="mi">652</span><span class="p">)</span>
<span class="mi">65</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_14_0.png" src="_images/14_2_interactivo_14_0.png" />
<hr class="docutils" />
<p><strong>Nota</strong> ¿Qué pasó acá?</p>
<p>La función <code class="docutils literal notranslate"><span class="pre">imshow()</span></code> está interpretando el valor de cada pixel como
una posición en una cierta escala de colores (<strong>colormap</strong>). Como no
especificamos cuál queremos utilizar, se usó el cmap <em>default</em>.</p>
<hr class="docutils" />
<p>Especifiquemos el <strong>colormap</strong> a utilizar para la graficación:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_17_0.png" src="_images/14_2_interactivo_17_0.png" />
<p>Los <code class="docutils literal notranslate"><span class="pre">cmap</span></code> aparecen también en el contexto de graficación de gráficos
de contorno (<code class="docutils literal notranslate"><span class="pre">contour()</span></code> y <code class="docutils literal notranslate"><span class="pre">contourf()</span></code>).</p>
<p>Al asociar un valor a un mapa de colores, la misma imagen puede
mostrarse de diferente maneras. Veamos otros ejemplos de <em>colormap</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_19_0.png" src="_images/14_2_interactivo_19_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno_r&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_20_0.png" src="_images/14_2_interactivo_20_0.png" />
<p>La referencia de ubicación de los <code class="docutils literal notranslate"><span class="pre">cmap</span></code> existentes está en:
<a class="reference external" href="http://matplotlib.org/examples/color/colormaps_reference.html">http://matplotlib.org/examples/color/colormaps_reference.html</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray_r&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_22_0.png" src="_images/14_2_interactivo_22_0.png" />
<section id="analisis-de-la-imagen">
<h3>Análisis de la imagen<a class="headerlink" href="#analisis-de-la-imagen" title="Permalink to this heading"></a></h3>
<p>La imagen es una representación en mapa de colores de lo valores en la
matriz. Esta es una representación que da muy buena información
cualitativa sobre las características de los datos. Para analizar los
datos a veces es más fácil hacer cortes o promediar en alguna dirección
los datos.</p>
<section id="histograma-de-intensidades">
<h4>Histograma de intensidades<a class="headerlink" href="#histograma-de-intensidades" title="Permalink to this heading"></a></h4>
<p>Un ejemplo es el cálculo de un histograma de intensidades, analizando
toda la imagen.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bin_centers</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Intensidad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_25_0.png" src="_images/14_2_interactivo_25_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creamos una figura con los dos gráficos</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># En el gráfico de la izquierda mostramos la imagen en escala de grises</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>   <span class="c1"># Eliminamos los dos ejes</span>
<span class="c1">#</span>
<span class="c1"># Graficamos a la derecha el histograma</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mf">0.85</span><span class="o">*</span><span class="n">hist</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;Histograma&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>   <span class="c1"># Sólo valores en el eje x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=-</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">left</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_26_0.png" src="_images/14_2_interactivo_26_0.png" />
<p>Estos histogramas, son útiles pero no dan información sobre las
variaciones de intensidad con la posición. De alguna manera estamos
integrando demasiado. Cuando vemos la imagen, vemos un mapa de
intensidad en dos dimensiones. Al hacer el histograma sobre toda la
figura perdemos completamente la información sobre la posición.</p>
</section>
<section id="cortes-en-una-direccion">
<h4>Cortes en una dirección<a class="headerlink" href="#cortes-en-una-direccion" title="Permalink to this heading"></a></h4>
<p>Un análisis intermedio podemos hacerlo haciendo cortes a lo largo de
alguna línea y analizando la intensidad. Por ejemplo, podemos elegir una
línea vertical en un punto <span class="math notranslate nohighlight">\(x_0\)</span>, y analizar como varía la
intensidad a lo largo de esa línea:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imag2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span>      <span class="c1"># Elegimos un punto en el eje x</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;posición en eje x=</span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s1"> de un total de </span><span class="si">{</span><span class="n">imag2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">posición</span> <span class="n">en</span> <span class="n">eje</span> <span class="n">x</span><span class="o">=</span><span class="mi">507</span> <span class="n">de</span> <span class="n">un</span> <span class="n">total</span> <span class="n">de</span> <span class="mi">652</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creamos la figura con dos subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># graficamos la imagen en el subplot de la derecha</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imag2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="c1"># y agregamos la línea vertical en el punto elegido</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="n">x0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;$x_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># Creamos linea como un array 1D con los datos a lo largo de la línea deseada</span>
<span class="c1"># y la graficamos</span>
<span class="n">linea</span> <span class="o">=</span> <span class="n">imag2</span><span class="p">[:,</span><span class="n">x0</span><span class="p">]</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linea</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Corte&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;posición en eje $y$ (pixels)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensidad&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">linea</span><span class="p">)))</span>
<span class="c1"># Ajustamos el margen izquierdo y la distancia entre los dos subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_30_0.png" src="_images/14_2_interactivo_30_0.png" />
</section>
</section>
</section>
<hr class="docutils" />
<section id="ejercicios-14-b">
<h2>Ejercicios 14 (b)<a class="headerlink" href="#ejercicios-14-b" title="Permalink to this heading"></a></h2>
<ol class="arabic simple" start="3">
<li><p>Modificar el ejemplo anterior para presentar en una figura tres
gráficos, agregando a la izquierda un panel donde se muestre un corte
horizontal. El corte debe estar en la mitad del gráfico
(<span class="math notranslate nohighlight">\(y_{0}=136\)</span>). En la figura debe mostrar la posición del corte
(similarmente a como se hizo con el corte en <span class="math notranslate nohighlight">\(x\)</span>) con una línea
de otro color.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="graficos-interactivos-widgets">
<h2>Gráficos interactivos (“widgets”)<a class="headerlink" href="#graficos-interactivos-widgets" title="Permalink to this heading"></a></h2>
<p>Veamos cómo se puede hacer este tipo de trabajo en forma interactiva.
Para ello <strong>Matplotlib</strong> tiene un submódulo <code class="docutils literal notranslate"><span class="pre">widgets</span></code> con rutinas que
están diseñadas para funcionar con cualquier <em>backend</em> interactivo. (más
información en: <a class="reference external" href="http://matplotlib.org/api/widgets_api.html">http://matplotlib.org/api/widgets_api.html</a>)</p>
<section id="cursor">
<h3>Cursor<a class="headerlink" href="#cursor" title="Permalink to this heading"></a></h3>
<p>Empecemos estudiando como agregar un indicador de la posición del cursor
a un gráfico.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archivo: ejemplo_cursor.py</span>

<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Cursor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Usamos: useblit = True en el backed gtkagg</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>En este caso, el programa está escrito separadamente y lo podemos
ejecutar desde la notebook (como en este caso) o desde una terminal
independientemente. Para ejecutar un script en forma interactiva desde
la <em>notebook</em> de <em>Jupyter</em> debemos setear el <em>backend</em> a una opción
interactiva (que no es el valor por default en las notebooks). En este
caso vamos a usar el backend <em>tk</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_36_0.png" src="_images/14_2_interactivo_36_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">tk</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">run</span> <span class="n">scripts</span><span class="o">/</span><span class="n">ejemplo_cursor</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>En este ejemplo simple conocemos casi todas las líneas (creamos la
figura y graficamos). Las líneas novedosas y relevantes son</p>
<ol class="arabic simple">
<li><p>La primera línea importando la función <code class="docutils literal notranslate"><span class="pre">Cursor()</span></code> para describir el
<em>cursor</em> o <em>mouse</em>:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Cursor</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>La línea en que usamos la función <code class="docutils literal notranslate"><span class="pre">Cursor</span></code></p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>que crea el objeto <code class="docutils literal notranslate"><span class="pre">Cursor</span></code>. La forma de esta función es:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Cursor</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">horizOn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vertOn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">lineprops</span><span class="p">)</span>
</pre></div>
</div>
<p>y toma como argumento el eje en el cuál agregamos el cursor. Como
argumentos opcionales se puede controlar la visibilidad de la línea
horizontal (<code class="docutils literal notranslate"><span class="pre">horizOn</span></code>) y vertical (<code class="docutils literal notranslate"><span class="pre">vertOn</span></code>) que pueden tomar
valores lógicos <code class="docutils literal notranslate"><span class="pre">True</span></code> o <code class="docutils literal notranslate"><span class="pre">False</span></code>. Además tiene argumentos <em>keyword</em>
para controlar la apariencia de las líneas. En este ejemplo pusimos
explícitamente que queremos una línea roja con un grosor igual a <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
</section>
<section id="manejo-de-eventos">
<h3>Manejo de eventos<a class="headerlink" href="#manejo-de-eventos" title="Permalink to this heading"></a></h3>
<p>Para que la interactividad sea útil es importante obtener datos de
nuestra interacción con el gráfico. Esto se obtiene con lo que se llama
“manejo de eventos” (“Event handling”).</p>
<p>Para recibir <em>events</em> necesitamos <strong>escribir y conectar</strong> una función
que se activa cuando ocurre el evento (<em>callback</em>). Veamos un ejemplo
simple pero importante, donde imprimimos las coordenadas donde se
presiona el <em>mouse</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostramos la figura (sin interactividad)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">run</span> <span class="n">scripts</span><span class="o">/</span><span class="n">ejemplo_callback</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<img alt="_images/14_2_interactivo_40_0.png" src="_images/14_2_interactivo_40_0.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Figure</span> <span class="n">size</span> <span class="mi">640</span><span class="n">x480</span> <span class="k">with</span> <span class="mi">0</span> <span class="n">Axes</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archivo: ejemplo_callback.py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;button=</span><span class="si">%d</span><span class="s1">, x=</span><span class="si">%d</span><span class="s1">, y=</span><span class="si">%d</span><span class="s1">, xdata=</span><span class="si">%f</span><span class="s1">, ydata=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span>
        <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>

<span class="n">cid</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/uso_callbacks1.png" src="_images/uso_callbacks1.png" />
<p>En este ejemplo utilizamos el método <code class="docutils literal notranslate"><span class="pre">mpl_connect</span></code> del objeto
<code class="docutils literal notranslate"><span class="pre">canvas</span></code>.</p>
<ul class="simple">
<li><p>El objeto <code class="docutils literal notranslate"><span class="pre">canvas</span></code> es el área donde se dibuja la figura.</p></li>
<li><p>La función <code class="docutils literal notranslate"><span class="pre">mpl_connect</span></code> realiza la conección de la función (que
aquí llamamos <code class="docutils literal notranslate"><span class="pre">onclick</span></code>) con la figura. Esta función toma como
argumento el <em>event</em> (que, para nosotros, es interpretado
automaticamente por Matplotlib)</p></li>
<li><p>El objeto <code class="docutils literal notranslate"><span class="pre">event</span></code> es de tipo <code class="docutils literal notranslate"><span class="pre">button_press_event</span></code>. Se dispara
cuando apretamos un botón del <em>mouse</em> y <em>matplotlib</em> le pasa como
argumento un objeto del tipo <code class="docutils literal notranslate"><span class="pre">event</span></code> que contiene información.
Nosotros estamos imprimiendo la siguiente información que contiene
<code class="docutils literal notranslate"><span class="pre">event</span></code> por pantalla:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">event.button</span></code>: indica que botón se presionó</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event.x</span></code>, <code class="docutils literal notranslate"><span class="pre">event.y</span></code>: dan la información sobre el índice en
los ejes horizontal y vertical</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event.xdata,</span> <span class="pre">event.ydata</span></code>: dan los valores de los datos en los
ejes.</p></li>
</ul>
</li>
</ul>
<p>Puede leer más información sobre el manejo de eventos en
<a class="reference external" href="http://matplotlib.org/users/event_handling.html">http://matplotlib.org/users/event_handling.html</a>.</p>
</section>
<section id="ejemplos-integrados">
<h3>Ejemplos integrados<a class="headerlink" href="#ejemplos-integrados" title="Permalink to this heading"></a></h3>
<p>Continuando con esta idea vamos a usar la capacidad de poder interactuar
con el gráfico para elegir una zona del gráfico de la cuál obtenemos
información sobre los datos.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archivo: scripts/analizar_figura_1.py</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Cursor</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../figuras/imagen_flujo_gray.jpg&#39;</span><span class="p">)</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">seleccionar</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Secuencia:</span>
<span class="sd">  1. Encuentro el punto donde el mouse hizo &#39;click&#39;</span>
<span class="sd">  2. Le doy valores a la línea vertical</span>
<span class="sd">  3. Le doy valores a la curva en el grafico de la derecha</span>
<span class="sd">  4. y 5. Grafico los nuevos valores</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">x0</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
  <span class="n">n0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
  <span class="n">l1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([[</span><span class="n">n0</span><span class="p">,</span> <span class="n">n0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
  <span class="n">l2</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">img</span><span class="p">[:,</span> <span class="n">n0</span><span class="p">])</span>
  <span class="n">l1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="n">l2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>


<span class="c1"># Defino la figura</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Mostramos la imagen como un mapa de grises</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Agrego la línea inicial en un valor inicial</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Grafico de la derecha</span>
<span class="n">l2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="n">x0</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;corte&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;posición en eje $y$ (pixels)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensidad&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Agrego el cursor y conecto la accion de presionar a la funcion click</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">horizOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vertOn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">seleccionar</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">tk</span>
<span class="o">%</span><span class="n">run</span> <span class="n">scripts</span><span class="o">/</span><span class="n">analizar_figura_1</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Este es un ejemplo un poco más largo (y un poquito más complejo).</p>
<ol class="arabic simple">
<li><p>Importamos los módulos y funciones necesarias.</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code> para casi todo</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imageio</span></code> para leer la figura</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">matplotlib.widgets</span> <span class="pre">import</span> <span class="pre">Cursor</span></code> para importar el objeto
<code class="docutils literal notranslate"><span class="pre">Cursor</span></code> que nos muestra la posición del mouse.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Leemos la imagen de archivo, creamos la figura y la mostramos.</p></li>
<li><p>Elegimos un valor de <span class="math notranslate nohighlight">\(x\)</span> inicial (igual a 100) y agregamos una
línea vertical en ese punto.</p></li>
<li><p>Creamos la figura de la derecha con los datos tomados de la columna
correspondiente de la matriz que representa la imagen.</p></li>
<li><p>Agregamos <em>labels</em> y ajustamos las distancias</p></li>
<li><p>Mostramos el cursor y le conectamos el evento (standard)
<code class="docutils literal notranslate"><span class="pre">button_press_event</span></code> a nuestra función <code class="docutils literal notranslate"><span class="pre">seleccionar()</span></code>.</p></li>
<li><p>La función <code class="docutils literal notranslate"><span class="pre">seleccionar()</span></code> toma como argumento el evento que se
dispara por interacción con el usuario.
El argumento <code class="docutils literal notranslate"><span class="pre">event</span></code> lo pasa automáticamente <em>Matplotlib</em>. En este
caso es un <em>click</em> del mouse en una zona del gráfico.</p></li>
</ol>
<p>La función <code class="docutils literal notranslate"><span class="pre">seleccionar(event)</span></code>: 1. Del argumento <code class="docutils literal notranslate"><span class="pre">event</span></code> extrae la
posición en el eje horizontal y lo asigna a la variable <code class="docutils literal notranslate"><span class="pre">x0</span></code>. 2. El
índice en el eje horizontal (<code class="docutils literal notranslate"><span class="pre">n0</span></code>). 2. Actualiza los datos de la línea
<code class="docutils literal notranslate"><span class="pre">l1</span></code> con valores para la línea vertical en el panel izquierdo. 4.
Actualiza la línea <code class="docutils literal notranslate"><span class="pre">l2</span></code> en la figura de la derecha con el corte en
<code class="docutils literal notranslate"><span class="pre">x0</span></code>. 5. Actualiza el dibujo de las líneas sobre el <em>canvas</em>.</p>
<p>El siguiente ejemplo es muy similar al anterior. Sólo estamos
actualizando la leyenda, para tener información del punto seleccionado.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">scripts</span><span class="o">/</span><span class="n">analizar_figura_2</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archivo:analizar_figura_2.py</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Cursor</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../figuras/imagen_flujo_gray.jpg&#39;</span><span class="p">)</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Secuencia:</span>
<span class="sd">  1. Encuentro el punto donde el mouse hizo &#39;click&#39;</span>
<span class="sd">  2. Le doy valores a la línea vertical</span>
<span class="sd">  3. Le doy valores a la curva en el grafico de la derecha</span>
<span class="sd">  4. y 5. Grafico los nuevos valores</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">x0</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
  <span class="n">n0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
  <span class="n">l1</span><span class="o">.</span><span class="n">set_data</span><span class="p">([[</span><span class="n">n0</span><span class="p">,</span> <span class="n">n0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
  <span class="n">l2</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">img</span><span class="p">[:,</span> <span class="n">n0</span><span class="p">])</span>
  <span class="n">leg2</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;corte en </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
  <span class="n">l1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="n">l2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>


<span class="c1"># Defino la figura</span>
<span class="c1"># Defino la figura</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="c1"># Agrego la línea inicial en un valor inicial</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Grafico de la derecha</span>
<span class="n">l2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="n">x0</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;corte en </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;posición en eje $y$ (pixels)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensidad&#39;</span><span class="p">)</span>
<span class="n">leg2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Agrego el cursor y conecto la accion de presionar a la funcion click</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">horizOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vertOn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">click</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Las diferencias más notables con el ejemplo anterior son:</p>
<ol class="arabic simple">
<li><p>Al crear la leyenda, asignamos el objeto creado a la variable
<code class="docutils literal notranslate"><span class="pre">leg2</span></code>, en la línea:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leg2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>En la función <code class="docutils literal notranslate"><span class="pre">click(event)</span></code> (equivalente a <code class="docutils literal notranslate"><span class="pre">seleccionar(evento)</span></code>
en el ejemplo anterior) actualizamos el texto de la leyenda con el
valor de <code class="docutils literal notranslate"><span class="pre">x0</span></code>:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leg2</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;corte en </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="ejercicios-14-c">
<h2>Ejercicios 14 (c)<a class="headerlink" href="#ejercicios-14-c" title="Permalink to this heading"></a></h2>
<ol class="arabic simple" start="4">
<li><p>Modificar el ejemplo anterior (<strong>analizar_figura_2.py</strong>) para
presentar tres gráficos, agregando a la izquierda un panel donde se
muestre el corte horizontal de la misma manera que en el ejercicio
anterior. Al seleccionar con el <em>mouse</em> debe mostrar los dos cortes
(horizontal y vertical).</p></li>
</ol>
<hr class="docutils" />
<p>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="clase_13.html" class="btn btn-neutral float-left" title="Clase 13: Interpolación y ajuste de curvas (fiteo)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="clase_15.html" class="btn btn-neutral float-right" title="Clase 15: Interfaces con otros lenguajes" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor IB - 2023, Juan Fiol.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>